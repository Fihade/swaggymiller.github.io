<!DOCTYPE html>
<html>
  <head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport">
  <title>MillerLiang</title>
  <link rel="shortcut icon" href="/images/favicon.ico">
  <!-- Jquery -->
  <script src="https://cdn.jsdelivr.net/jquery/2.1.3/jquery.min.js"></script>
  <!-- Google Fonts -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Noto+Sans+SC:400,700|Roboto+Condensed:700">
  <!-- prettify -->
  <link rel="stylesheet" href="/prettify/atelier-sulphurpool-light.min.css">
  <script src="/prettify/prettify.js"></script>

  <link rel="stylesheet" href="/css/style.css">
  <script src="/js/script.js"></script>
</head>
  <body>
    <div class="container">
      <header>
  <div class="header">
    <div class="blog-title">
      <a href="/" class="logo">MillerLiang</a>
    </div>
    <nav class="navbar hidden-xs-only">
      <ul class="menu">
        
          <li class="menu-item">
            <a href="/" class="menu-item-link">Home</a>
          </li>
        
          <li class="menu-item">
            <a href="/archives" class="menu-item-link">Archives</a>
          </li>
        
          <li class="menu-item">
            <a href="https://github.com/swaggymiller" class="menu-item-link">Github</a>
          </li>
        
      </ul>
    </nav>
  </div>

  <nav class="header-nav hidden-sm-and-up">
    <ul class="menu">
      
        <li class="menu-item">
          <a href="/" class="menu-item-link">Home</a>
        </li>
      
        <li class="menu-item">
          <a href="/archives" class="menu-item-link">Archives</a>
        </li>
      
        <li class="menu-item">
          <a href="https://github.com/swaggymiller" class="menu-item-link">Github</a>
        </li>
      
    </ul>
  </nav>
  
</header>
      <main class="main">
        <article class="post">
  <div class="post-title">
    <h2 class="title">ğŸ“ŸJson/Httpç›¸å…³è®°å½•</h2>
  </div>
   <div class="post-meta">
    <span class="post-time">2018-05-20</span>
    <span class="post-author">æ¢æ–Œ</span>
  </div>
  <div class="post-content">
    <blockquote>
<p>âŒ›ä¸€ç›´ä¼šä¸å®šæœŸæ›´ä¸€ä¸‹â€¦<br>ä¸Šä¸€ä¸ªå¼€å§‹å­¦ä¹ androidç«¯çš„jsonæ–¹é¢çš„ç›¸å…³çŸ¥è¯†ï¼Œå­¦äº†è¿‘ä¸¤ä¸ªå‘¨ï¼Œå› ä¸ºæ¯å¤©è¦ä¸Šè¯¾ï¼Œæ‰€ä»¥ä¼šæ–­æ–­ç»­ç»­ï¼Œæ¥ä¸‹æ¥æˆ‘æƒ³è®°å½•ä¸€ä¸‹æœ€è¿‘çš„å­¦ä¹ æˆæœä»¥åŠ check in ä¸€ä¸‹ã€‚</p>
</blockquote>
<h3 id="å…³äºJson"><a href="#å…³äºJson" class="headerlink" title="å…³äºJson"></a>å…³äºJson</h3><blockquote>
<p>Json æ˜¯ä¸€ç§è½»é‡çº§çš„æ•°æ®äº¤æ¢æ ¼å¼,å¯¹äºæˆ‘è€Œè¨€å®ƒæ›´åƒæ˜¯ä¸€ç§ç”¨æ¥å­˜å‚¨æ•°æ®çš„æŸç§ç»“æ„ï¼Œåœ¨ Android ä¸­èƒ½å¤Ÿé€šè¿‡ç»™å®šçš„ç›¸å…³ç±»ï¼Œè°ƒç”¨ç›¸å…³æ–¹æ³•ï¼Œå¯ä»¥è¾¾åˆ°è·å–æ•°æ®ï¼Œå“åº”æ•°æ®çš„æ•ˆæœã€‚</p>
</blockquote>
<h2 id="Jsonç›¸å…³ä¿¡æ¯"><a href="#Jsonç›¸å…³ä¿¡æ¯" class="headerlink" title="Jsonç›¸å…³ä¿¡æ¯"></a>Jsonç›¸å…³ä¿¡æ¯</h2><blockquote>
<p>é’ˆå¯¹äºJsonæ¥è¯´ä¸‡äº‹ä¸‡ç‰©éƒ½æ˜¯å¯¹è±¡ï¼Œæ¯ä¸ªå¯¹è±¡éƒ½ä¼šä»¥é”®å€¼å¯¹çš„å½¢å¼æ¥è¡¨è¾¾ï¼ˆä¸è¿‡å¯¹ä¸ key åŠ åŒå¼•å·æœ‰ç‚¹ä¸å¤ªé€‚åº”ğŸ™ƒï¼‰ï¼Œæ‰€ä»¥Jsonæ¶‰åŠä¸€äº›è¯­æ³•</p>
<ul>
<li>å¯¹è±¡è¡¨ç¤ºä¸ºé”®å€¼å¯¹</li>
<li>æ•°æ®ç”±é€—å·åˆ†éš”</li>
<li>èŠ±æ‹¬å·ä¿å­˜å¯¹è±¡</li>
<li>æ–¹æ‹¬å·ä¿å­˜æ•°ç»„</li>
</ul>
</blockquote>
<h2 id="äº†è§£è¿™äº›å¸®åŠ©æˆ‘ä»¬å¯ä»¥åœ¨è·å–Jsonå€¼çš„æ—¶å€™ï¼Œé€‰æ‹©æ­£ç¡®çš„å­˜å‚¨ç»“æ„"><a href="#äº†è§£è¿™äº›å¸®åŠ©æˆ‘ä»¬å¯ä»¥åœ¨è·å–Jsonå€¼çš„æ—¶å€™ï¼Œé€‰æ‹©æ­£ç¡®çš„å­˜å‚¨ç»“æ„" class="headerlink" title="äº†è§£è¿™äº›å¸®åŠ©æˆ‘ä»¬å¯ä»¥åœ¨è·å–Jsonå€¼çš„æ—¶å€™ï¼Œé€‰æ‹©æ­£ç¡®çš„å­˜å‚¨ç»“æ„"></a>äº†è§£è¿™äº›å¸®åŠ©æˆ‘ä»¬å¯ä»¥åœ¨è·å–Jsonå€¼çš„æ—¶å€™ï¼Œé€‰æ‹©æ­£ç¡®çš„å­˜å‚¨ç»“æ„</h2><h2 id="åœ¨Androidå¼€å‘ä¸­ä½¿ç”¨"><a href="#åœ¨Androidå¼€å‘ä¸­ä½¿ç”¨" class="headerlink" title="åœ¨Androidå¼€å‘ä¸­ä½¿ç”¨"></a>åœ¨Androidå¼€å‘ä¸­ä½¿ç”¨</h2><p>å…³äºHttpè¯·æ±‚(<b>makeHttpRequest(URL url)</b>)ï¼š</p>
<blockquote>
<p>åˆšå¼€å§‹æˆ‘ä»¬éœ€è¦ä¸€äº›ç›¸å…³å˜é‡ï¼Œæ‰€ä»¥æˆ‘åœ¨è¿™é‡Œå…ˆå®šä¹‰äº†â˜º</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">String jsonResponse = <span class="string">""</span>;</span><br><span class="line"><span class="keyword">if</span> (url == <span class="keyword">null</span>)&#123;</span><br><span class="line">    <span class="keyword">return</span> jsonResponse;</span><br><span class="line">&#125;</span><br><span class="line">HttpURLConnection urlConnection = <span class="keyword">null</span>;</span><br><span class="line">InputStream inputStream = <span class="keyword">null</span>;</span><br></pre></td></tr></table></figure>
<blockquote>
<ul>
<li>éœ€è¦æ„é€ url,å°†Stringç±»å‹çš„urlåœ°å€è½¬æ¢æˆURLç±»å‹ï¼ˆcatchâ€¦.throwsæ–¹æ³•â€¦ï¼‰</li>
</ul>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//è¾…åŠ©æ–°æ–¹æ³•</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> URL <span class="title">creatUrl</span><span class="params">(String stringUrl)</span></span>&#123;</span><br><span class="line">    URL url = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">try</span>&#123;</span><br><span class="line">       url = <span class="keyword">new</span> URL(stringUrl);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (MalformedURLException e) &#123;</span><br><span class="line">        Log.i(<span class="string">"tag"</span>,<span class="string">"Problem about the URL"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> url;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<ul>
<li>æ„é€ HttpRequestè¯·æ±‚ï¼Œå°†ä¸Šä¸€æ­¥çš„URLä¼ å‚ï¼Œæ„é€ å®ä¾‹åŒ–HttpURLConnection urlConnection</li>
</ul>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">HttpURLConnection urlConnection = <span class="keyword">null</span>;</span><br><span class="line">InputStream inputStream = <span class="keyword">null</span>;</span><br><span class="line"><span class="keyword">try</span>&#123;</span><br><span class="line">      urlConnection = (HttpURLConnection) url.openConnection(); <span class="comment">//æ‰“å¼€è¿æ¥</span></span><br><span class="line">      urlConnection.setReadTimeout(<span class="number">10000</span>);                      <span class="comment">//è¯»å–æ—¶é—´å»¶è¿Ÿ</span></span><br><span class="line">      urlConnection.setConnectTimeout(<span class="number">15000</span>);                   <span class="comment">//è¿æ¥æ—¶é—´å»¶è¿Ÿ</span></span><br><span class="line">      urlConnection.setRequestMethod(<span class="string">"GET"</span>);                    <span class="comment">//è¯·æ±‚æ–¹æ³•â€œGETâ€</span></span><br><span class="line">      urlConnection.connect();                                  <span class="comment">//è¿æ¥</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>\3. åˆ¤æ–­è·å–è¿æ¥ä¹‹åè¿”å›çš„å€¼getResponseCodeåˆ¤æ–­æ˜¯å¦è¿æ¥æˆåŠŸï¼Œåœ¨httpé“¾æ¥ä¸­ä¸€èˆ¬è¿”å›200ä¸ºè¿æ¥æˆåŠŸï¼Œç„¶åå°±éœ€è¦é€šè¿‡ä¸Šä¸€æ­¥ä¸­çš„urlconnectionè¿›è¡Œå…ˆè·å–</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//è¯·æ±‚æˆåŠŸå“åº”200</span></span><br><span class="line"><span class="comment">//ç„¶åè¯»å–è¾“å…¥æµæ•°æ®</span></span><br><span class="line"><span class="keyword">if</span>(urlConnection.getResponseCode() == <span class="number">200</span>)&#123;</span><br><span class="line">      ......</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>4.å½“æˆ‘ä»¬è¿æ¥æˆåŠŸä»¥åï¼Œè¿™æ—¶å€™æˆ‘ä»¬å°±å¯ä»¥ä»URlé‡Œé¢è·å–ä¸€äº›æ•°æ®ï¼Œè¿™ä¸ªæ—¶å€™éœ€è¦ç”¨åˆ°ä¹‹å‰çš„å˜é‡inputstream,inputstreamä½œä¸ºä¸€ä¸ªæŠ½è±¡ç±»ï¼Œç›¸å½“äºâ€œå¼•æº â€çš„ä½œç”¨ï¼Œæ ‡å¿—å¤šç§ç±»å‹çš„æ•°æ®ï¼Œç„¶åè°ƒç”¨.getinputstreamæ–¹æ³•ï¼Œæ ‡è®°æ‰€æœ‰ä»urlçš„ä¿¡æ¯ï¼Œç„¶åè°ƒç”¨æ–¹æ³•å¼€å§‹ â€œ è¯»å–æ•°æ® â€äº†ï¼ˆinputstream ç›¸å½“äºå‹ç¼©è¿‡çš„æ•°æ®ï¼Œä¾ç„¶éœ€è¦æˆ‘ä»¬å†æ¬¡è§£æ</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//ç„¶åè¯»å–è¾“å…¥æµæ•°æ®</span></span><br><span class="line"><span class="keyword">if</span>(urlConnection.getResponseCode() == <span class="number">200</span>)&#123;</span><br><span class="line">      inputStream = urlConnection.getInputStream();</span><br><span class="line">      jsonResponse = readFromStream(inputStream);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>5.è¿™æ—¶inputstreamä¹‹åï¼Œéœ€è¦è¯»å–è¾“å…¥æµæ•°æ®ï¼Œè½¬æ¢æˆjsongæ•°æ®æ ¼å¼ç±»å‹ï¼Œéœ€è¦ç”¨åˆ°é™æ€æŠ½è±¡ç±»BufferedReaderæ¥ä»å­—ç¬¦è¾“å…¥æµä¸­è¯»å–æ–‡æœ¬ï¼Œç¼“å†²å„ä¸ªå­—ç¬¦ï¼Œä»è€Œå®ç°å­—ç¬¦ã€æ•°ç»„å’Œè¡Œçš„é«˜æ•ˆè¯»å–ï¼ˆè¿™å¥è¯æ‘˜æŠ„çš„â˜º</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//è¯»å–è¾“å…¥æµæ•°æ®</span></span><br><span class="line"><span class="comment">//è½¬æ¢ä¸ºåŒ…å«jsonæ•°æ®çš„æ ¼å¼</span></span><br><span class="line">   <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> String <span class="title">readFromStream</span><span class="params">(InputStream inputStream)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">       StringBuilder output = <span class="keyword">new</span> StringBuilder();</span><br><span class="line">       <span class="keyword">if</span>(inputStream != <span class="keyword">null</span>)&#123;</span><br><span class="line">           InputStreamReader inputStreamReader = <span class="keyword">new</span> InputStreamReader(inputStream , Charset.forName(<span class="string">"UTF-8"</span>));</span><br><span class="line">           BufferedReader reader = <span class="keyword">new</span> BufferedReader(inputStreamReader);</span><br><span class="line">           String line = reader.readLine();</span><br><span class="line">           <span class="keyword">while</span>(line != <span class="keyword">null</span>)&#123;</span><br><span class="line">               <span class="comment">//apend()è¿æ¥æ•°æ®</span></span><br><span class="line">               line = reader.readLine();</span><br><span class="line">               output.append(line);</span><br><span class="line">           &#125;</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="keyword">return</span> output.toString();</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>
<p>å¯¹äºjsonæ¥è¯´ï¼Œé¦–å…ˆéœ€è¦äº†è§£æ•´ä¸ªjsonçš„æ–‡ä»¶æ ¼å¼ï¼Œä¾‹å¦‚</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"type"</span>: <span class="string">"FeatureCollection"</span>,</span><br><span class="line">  <span class="attr">"metadata"</span>: &#123;</span><br><span class="line">    <span class="attr">"generated"</span>: <span class="number">1523110898000</span>,</span><br><span class="line">    <span class="attr">"url"</span>: <span class="string">"https://earthquake.usgs.gov/fdsnws/event/1/query?starttime=2018-03-10&amp;endtime=2018-03-12&amp;format=geojson"</span>,</span><br><span class="line">    <span class="attr">"title"</span>: <span class="string">"USGS Earthquakes"</span>,</span><br><span class="line">    <span class="attr">"status"</span>: <span class="number">200</span>,</span><br><span class="line">    <span class="attr">"api"</span>: <span class="string">"1.5.8"</span>,</span><br><span class="line">    <span class="attr">"count"</span>: <span class="number">737</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">"features"</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">"type"</span>: <span class="string">"Feature"</span>,</span><br><span class="line">      <span class="attr">"properties"</span>: &#123;</span><br><span class="line">        <span class="attr">"mag"</span>: <span class="number">0.4</span>,</span><br><span class="line">        <span class="attr">"place"</span>: <span class="string">"10km NNW of Incline Village, Nevada"</span>,</span><br><span class="line">        <span class="attr">"time"</span>: <span class="number">1520812711481</span>,</span><br><span class="line">        <span class="attr">"updated"</span>: <span class="number">1520820364368</span>,</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>6.å¯¹äºç¬¬5æ­¥è·å–çš„jsonæ ¼å¼çš„æ•°æ®ï¼Œé€šè¿‡åˆ›å»ºjsonå“åº”å­—ç¬¦è·å–æ•°ç»„ï¼Œå…¶æ¬¡è·å–å¯¹åº”çš„å…ƒç´ ä¿¡æ¯ï¼Œåœ¨ä¸‹é¢çš„ä»£ç å¯ä»¥çœ‹åˆ°é¦–å…ˆç”¨äº†JSONArrayæ•°ç»„æ¥å­˜å‚¨æ•´ä¸ªJsonæ•°æ®çš„æ‰€æœ‰é”®å€¼å¯¹ï¼Œç”¨JSONObjectå¯¹è±¡è°ƒç”¨getJSONObjectè·å–Jsonæ•°æ®çš„å¯¹åº”å€¼</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> List&lt;Earthquake&gt; <span class="title">extractFeatureFromJson</span><span class="params">(String  earthquakeJSON)</span> </span>&#123;</span><br><span class="line">       <span class="comment">//å¦‚æœjsonä¸ºnullæå‰è¿”å›</span></span><br><span class="line">       <span class="keyword">if</span>(TextUtils.isEmpty(earthquakeJSON))&#123;</span><br><span class="line">           <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">       &#125;</span><br><span class="line">       List&lt;Earthquake&gt; earthquakes = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line"></span><br><span class="line">       <span class="keyword">try</span>&#123;</span><br><span class="line">           <span class="comment">//é€šè¿‡jsonå“åº”å­—ç¬¦åˆ›å»ºjsonobject</span></span><br><span class="line">           JSONObject baseJsonResponse = <span class="keyword">new</span> JSONObject(earthquakeJSON);</span><br><span class="line">           <span class="comment">//æå–å…³é”®å­—â€œfeatureâ€çš„é”®å€¼ï¼Œæ„æˆArrayæ•°ç»„</span></span><br><span class="line">           JSONArray earthquakeArray = baseJsonResponse.getJSONArray(<span class="string">"features"</span>);</span><br><span class="line">           <span class="comment">//éå†å¾ªç¯Arrayä¸­çš„æ¯ä¸€ä¸ªå…ƒç´ ï¼Œè·å–ä¿¡æ¯</span></span><br><span class="line">           <span class="keyword">for</span>(<span class="keyword">int</span> i= <span class="number">0</span>; i&lt;earthquakeArray.length();i++)&#123;</span><br><span class="line">               <span class="comment">//å®ä¾‹åŒ–ä¸€ä¸ªjsonobjectçš„å¯¹è±¡</span></span><br><span class="line">               JSONObject currentEarthquake = earthquakeArray.getJSONObject(i);</span><br><span class="line">               <span class="comment">//åˆ›å»ºå¯¹è±¡è·å–propertiesä¸‹çš„å€¼ï¼Œä¸‹é¢å¾—åˆ°å€¼å‡åœ¨â€œpropertiesâ€ä¸‹é¢</span></span><br><span class="line">               JSONObject properties = currentEarthquake.getJSONObject(<span class="string">"properties"</span>);</span><br><span class="line">               <span class="comment">//è·å–magnitudeçš„å€¼</span></span><br><span class="line">               <span class="keyword">double</span> magnitude = properties.getDouble(<span class="string">"mag"</span>);</span><br><span class="line">               <span class="comment">//è·å–locationçš„å€¼</span></span><br><span class="line">               String location = properties.getString(<span class="string">"place"</span>);</span><br><span class="line">               <span class="comment">//è·å–timeçš„å€¼</span></span><br><span class="line">               <span class="keyword">long</span> time = properties.getLong(<span class="string">"time"</span>);</span><br><span class="line">               <span class="comment">//è·å–urlçš„å€¼</span></span><br><span class="line">               String url = properties.getString(<span class="string">"url"</span>);</span><br><span class="line">               <span class="comment">//åˆ›å»ºæ–°çš„Earthquakeå¯¹è±¡</span></span><br><span class="line">               Earthquake earthquake = <span class="keyword">new</span> Earthquake(magnitude,location,time,url);</span><br><span class="line"></span><br><span class="line">               <span class="comment">//å°†æ–°çš„earthquakeå¯¹è±¡æ·»åŠ åˆ°åˆ—è¡¨ä¸­</span></span><br><span class="line">               earthquakes.add(earthquake);</span><br><span class="line"></span><br><span class="line">           &#125;</span><br><span class="line"></span><br><span class="line">       &#125; <span class="keyword">catch</span> (JSONException e) &#123;</span><br><span class="line"></span><br><span class="line">           Log.e(<span class="string">"QueryUtils"</span>, <span class="string">"Problem parsing the earthquake JSON results"</span>, e);</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       <span class="comment">// Return the list of earthquakes</span></span><br><span class="line">       <span class="keyword">return</span> earthquakes;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>7.æœ€åçš„æœ€åå°†ä¸Šé¢çš„å››ä¸ªå‡½æ•°éœ€è¦æˆ‘ä»¬æ•´åˆåœ¨ä¸€èµ·ï¼Œå»ºç«‹ä¸€ä¸ªåä¸ºfetchDataï¼ˆString requesturlï¼‰å‡½æ•°ï¼Œå°†è¿™äº›å‡½æ•°çš„è¿”å›å€¼ä¸€ä¸€å¯¹åº”ï¼Œreturnå›ä¸€ä¸ªè‡ªå·±æ‰€éœ€è¦çš„å‚¨å­˜æ•°æ®çš„æ•°æ®ç±»å‹ï¼Œåœ¨è¿™é‡Œæˆ‘è¿”å›äº†ä¸€ä¸ªList&lt;&gt;ç±»å‹çš„æ•°æ®åˆ—è¡¨ï¼Œå¹¶ä¸”é«“å¤–å¼€æ”¾ä¸ºpublicç±»å‹çš„å‡½æ•°</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//è¯¥æ–¹æ³•å°†æ‰€æœ‰æ­¥éª¤è¿æ¥åœ¨ä¸€èµ·ï¼Œå”¯ä¸€çš„publicå‡½æ•°</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span>  List&lt;Earthquake&gt; <span class="title">fetchEarthquakeData</span><span class="params">(String requestUrl)</span></span>&#123;</span><br><span class="line">    <span class="comment">//åˆ›å»ºurlå¯¹è±¡</span></span><br><span class="line">    URL url = creatUrl(requestUrl);</span><br><span class="line">    <span class="comment">//æ‰§è¡Œurlçš„httpè¯·æ±‚å¹¶è¿”å›jsonå“åº”</span></span><br><span class="line">    String jsonResponse = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        jsonResponse = makeHttpRequest(url);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">        Log.e(LOG_TAG,<span class="string">"Problem about makehttpRequest"</span>,e);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//ä»jsonå“åº”æ•°æ®æå–ç›¸å…³ä¿¡æ¯å¹¶åˆ›å»ºåˆ—è¡¨</span></span><br><span class="line">    List&lt;Earthquake&gt; earthquakes = extractFeatureFromJson(jsonResponse);</span><br><span class="line">    <span class="comment">//return åˆ—è¡¨</span></span><br><span class="line">    <span class="keyword">return</span> earthquakes;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="ä»¥åæœ‰æ–°çš„ä½“ä¼šå†æ¥æ›´æ–°ğŸ‘º"><a href="#ä»¥åæœ‰æ–°çš„ä½“ä¼šå†æ¥æ›´æ–°ğŸ‘º" class="headerlink" title="ä»¥åæœ‰æ–°çš„ä½“ä¼šå†æ¥æ›´æ–°ğŸ‘º"></a>ä»¥åæœ‰æ–°çš„ä½“ä¼šå†æ¥æ›´æ–°ğŸ‘º</h2><h3 id="Stop-stoping"><a href="#Stop-stoping" class="headerlink" title="Stop stoping"></a>Stop stoping</h3><h3 id="å¼€å§‹çœ‹Gsonå’ŒFastJson"><a href="#å¼€å§‹çœ‹Gsonå’ŒFastJson" class="headerlink" title="å¼€å§‹çœ‹Gsonå’ŒFastJson"></a>å¼€å§‹çœ‹Gsonå’ŒFastJson</h3><h3 id="æ¥ä¸Šä¸€æ¡ï¼Œçœ‹å®Œäº†-à¸‡-â€¢-â€¢-à¸‡"><a href="#æ¥ä¸Šä¸€æ¡ï¼Œçœ‹å®Œäº†-à¸‡-â€¢-â€¢-à¸‡" class="headerlink" title="æ¥ä¸Šä¸€æ¡ï¼Œçœ‹å®Œäº†/(à¸‡ â€¢_â€¢)à¸‡/"></a>æ¥ä¸Šä¸€æ¡ï¼Œçœ‹å®Œäº†/(à¸‡ â€¢_â€¢)à¸‡/</h3>
  </div>
</article>
      </main>
    </div>
  </body>
</html>