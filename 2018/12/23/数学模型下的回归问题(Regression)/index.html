<!DOCTYPE html>
<html>
  <head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport">
  <title>MillerLiang</title>
  <link rel="shortcut icon" href="/images/favicon.ico">
  <!-- Jquery -->
  <script src="https://cdn.jsdelivr.net/jquery/2.1.3/jquery.min.js"></script>
  <!-- Google Fonts -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Noto+Sans+SC:400,700|Roboto+Condensed:700">
  <!-- prettify -->
  <link rel="stylesheet" href="/prettify/atelier-sulphurpool-light.min.css">
  <script src="/prettify/prettify.js"></script>

  <link rel="stylesheet" href="/css/style.css">
  <script src="/js/script.js"></script>
</head>
  <body>
    <div class="container">
    
      <header>
  <div class="header">
    <div class="blog-title">
      <a href="/" class="logo">MillerLiang</a>
    </div>
    <nav class="navbar hidden-xs-only">
      <ul class="menu">
        
          <li class="menu-item">
            <a href="/" class="menu-item-link">é¦–é¡µ</a>
          </li>
        
          <li class="menu-item">
            <a href="/archives" class="menu-item-link">å½’æ¡£</a>
          </li>
        
          <li class="menu-item">
            <a href="https://github.com/swaggymiller" class="menu-item-link">Github</a>
          </li>
        
      </ul>
    </nav>
  </div>

  <nav class="header-nav hidden-sm-and-up">
    <ul class="menu">
      
        <li class="menu-item">
          <a href="/" class="menu-item-link">é¦–é¡µ</a>
        </li>
      
        <li class="menu-item">
          <a href="/archives" class="menu-item-link">å½’æ¡£</a>
        </li>
      
        <li class="menu-item">
          <a href="https://github.com/swaggymiller" class="menu-item-link">Github</a>
        </li>
      
    </ul>
  </nav>
  
</header>
      <main class="main">
        <article class="post">
  <div class="post-title">
    <h2 class="title">ğŸ“¡æ•°å­¦æ¨¡å‹ä¸‹çš„å›å½’é—®é¢˜(Regression)</h2>
  </div>
   <div class="post-meta">
    <span class="post-time">2018-12-23</span>
    <span class="post-author"></span>
  </div>
  <div class="post-content">
    <h4 id="1-æ•°å­¦æ¨¡å‹ä¸­çš„åŸºæœ¬å»ºç«‹"><a href="#1-æ•°å­¦æ¨¡å‹ä¸­çš„åŸºæœ¬å»ºç«‹" class="headerlink" title="1. æ•°å­¦æ¨¡å‹ä¸­çš„åŸºæœ¬å»ºç«‹"></a>1. æ•°å­¦æ¨¡å‹ä¸­çš„åŸºæœ¬å»ºç«‹</h4><ul>
<li><h5 id="å•ä¸€å˜é‡"><a href="#å•ä¸€å˜é‡" class="headerlink" title="å•ä¸€å˜é‡**"></a>å•ä¸€å˜é‡**</h5></li>
</ul>
<p>$$<br>h_\theta(x) = \theta_0+\theta_1*x<br>$$</p>
<p>å³ï¼š<br>$$<br>y^ i  = \theta_0 + \theta_1*x^i<br>$$</p>
<ul>
<li><strong>Cost Function</strong></li>
</ul>
<p>æ­¤æ—¶è®­ç»ƒçš„çº¿æ€§å‡½æ•°çš„æ±‚è§£ä¸åŸæ•°æ®åšå·®ï¼Œç„¶åå–ä¸ªå¹³æ–¹ï¼š<br>$$<br>J_i(\theta) = (y_1^i - y^i)^2<br>$$<br>å°†è¿™äº›å¹³æ–¹å·®æ±‚å’Œï¼Œå¹¶å–å¹³å‡æ•°ï¼Œå†é™¤ä»¥2ï¼ˆå› ä¸ºå¹³æ–¹é¡¹åœ¨æ±‚å¯¼çš„æ—¶å€™å¯ä»¥ä¸è¿™ä¸ªåˆ†æ¯2æŠµæ¶ˆï¼‰ï¼š<br>$$<br>J_\theta = 1/2m \sum_{i=1}^{m}(y_1^i - y^i)^2<br>$$</p>
<ul>
<li><strong>æœ€ä¼˜è§£</strong></li>
</ul>
<p>æ­¤æ—¶æ±‚è§£å…³äºtheta0å’Œ theta 1çš„æ–¹ç¨‹ï¼Œæ­¤æ—¶å½“æ±‚è§£å¤„Jçš„æœ€å°å€¼ï¼Œå³åœ¨ç»˜åˆ¶æ›²çº¿çš„æ—¶å€™åœ¨æ›²çº¿çš„æœ€ä½ç‚¹å³ä¸ºJçš„æœ€å°å€¼ï¼Œæ­¤æ—¶å–thetaé›†ï¼š<br>$$<br>min(J_\theta) = min( 1/2m \sum_{i=1}^{m} (y_1^i - y^i)^2)<br>$$</p>
<ul>
<li><strong>Gradient Descent</strong></li>
</ul>
<p>é€šè¿‡æ¢¯åº¦ä¸‹é™çš„æ–¹æ³•è¿›è¡Œæ±‚è§£æœ€ä¼˜è§£ï¼Œåˆ™ä¸€å¼€å§‹é€‰æ‹©ä¸€ä¸ªè§£ï¼Œç„¶åæ²¿ç€ä¸€å®šçš„æ–¹å‘çš„é€æ¸é è¿‘ï¼ˆä¸‹é™ï¼‰è¿™ä¸ªå€¼ï¼š<br>$$<br>temp0 = \theta_0 - \alpha <em> \frac{\part}{d\theta_0}J(\theta_0,\theta_1) \<br>temp1 = \theta_0 - \alpha </em> \frac{\part}{d\theta_1}J(\theta_0,\theta_1) \<br>\theta_0 = temp0 \<br>\theta_1 = temp1<br>$$<br>$\bigtriangleup$$æ­¤æ—¶æ±‚è§£$ $t  emp1ä¸­$$çš„ $$\theta_0$$ä¸º $$temp0$$ ï¼Œéœ€è¦æ—¶æ—¶æ›´æ–°è¿™ä¸ªå€¼</p>
<ul>
<li>å¯¹äº$$\alpha$$çš„é€‰æ‹©ï¼Œå¦‚æœå¤ªå°ï¼Œåˆ™æ¢¯åº¦ä¸‹é™çš„é€Ÿç‡ä¼šå¾ˆæ…¢</li>
<li>å¦‚æœ$$\alpha$$å–å€¼å¤ªå¤§ï¼Œæ¢¯åº¦ä¸‹é™å¯èƒ½ä¼šè·³è¿‡æœ€ä¼˜è§£</li>
</ul>
<p>æœ€åå°†æ¯æ¬¡æ¢¯åº¦ä¸‹é™çš„å€¼åº”ç”¨åˆ°  $$J_\theta = 1/2m \sum_{i=1}^{m}(y_1^i - y^i)^2$$  ä¸­å»ï¼š</p>
<ul>
<li><strong>æ¢¯åº¦æ±‚å¯¼è¿‡ç¨‹ï¼š</strong></li>
</ul>
<p>$$<br>\frac{\part}{d\theta_j}J(\theta_0,\theta_1) = \frac {\part}{\part \theta_j}\frac{1}{2m}\sum_{i=1}^{m}(\theta_0+\theta_1x_i - y_i)^2<br>$$</p>
<p><strong>j = 0:</strong><br>$$<br>\frac{\part}{d\theta_j}J(\theta_0,\theta_1) = \frac {\part}{\part \theta_j}\frac{1}{m}\sum_{i=1}^{m}(\theta_0+\theta_1x_i - y_i)<br>$$<br><strong>j = 1:</strong><br>$$<br>\frac{\part}{d\theta_j}J(\theta_0,\theta_1) = \frac {\part}{\part \theta_j}\frac{1}{m}\sum_{i=1}^{m}(\theta_0+\theta_1x_i - y_i)*x_i<br>$$</p>
<h4 id="2-åœ¨-pytorch-è¿›è¡Œå®è·µä¸éªŒè¯"><a href="#2-åœ¨-pytorch-è¿›è¡Œå®è·µä¸éªŒè¯" class="headerlink" title="2. åœ¨ $$pytorch$$ è¿›è¡Œå®è·µä¸éªŒè¯"></a>2. åœ¨ $$pytorch$$ è¿›è¡Œå®è·µä¸éªŒè¯</h4><ul>
<li><p>é¦–å…ˆï¼Œäººä¸ºåˆ¶é€ å»ºç«‹ä¸€ä¸ª$$y = x^2$$ çš„å‡½æ•°è¿›è¡Œå›å½’æ‹Ÿåˆ</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">x = torch.unsqueeze(torch.linspace(<span class="number">-1</span>, <span class="number">1</span>, <span class="number">100</span>), dim=<span class="number">1</span>)	<span class="comment"># å°†æ•£ç‚¹è½¬åŒ–ä¸ºäºŒç»´å˜é‡</span></span><br><span class="line">y = x.pow(<span class="number">2</span>) + <span class="number">0.2</span> * torch.rand(x.size())				<span class="comment"># torch.rand(x.size())åŠ å™ªç‚¹</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>å°†  $$x$$ ,  $$y$$ è½¬åŒ–ä¸º  $$Variable$$  å˜é‡</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">x, y = Variable(x), Variable(y)</span><br></pre></td></tr></table></figure>
</li>
<li><p>å»ºç«‹ç¥ç»ç½‘ç»œ</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Net</span><span class="params">(torch.nn.Module)</span>:</span>  <span class="comment"># ç»§æ‰¿ torch çš„ Module</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, n_feature, n_hidden, n_output)</span>:</span></span><br><span class="line">        super(Net, self).__init__()     <span class="comment"># ç»§æ‰¿ __init__ åŠŸèƒ½</span></span><br><span class="line">        <span class="comment"># å®šä¹‰æ¯å±‚ç”¨ä»€ä¹ˆæ ·çš„å½¢å¼</span></span><br><span class="line">        self.hidden = torch.nn.Linear(n_feature, n_hidden)   <span class="comment"># éšè—å±‚çº¿æ€§è¾“å‡º</span></span><br><span class="line">        self.predict = torch.nn.Linear(n_hidden, n_output)   <span class="comment"># è¾“å‡ºå±‚çº¿æ€§è¾“å‡º</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">forward</span><span class="params">(self, x)</span>:</span>   <span class="comment"># è¿™åŒæ—¶ä¹Ÿæ˜¯ Module ä¸­çš„ forward åŠŸèƒ½</span></span><br><span class="line">        <span class="comment"># æ­£å‘ä¼ æ’­è¾“å…¥å€¼, ç¥ç»ç½‘ç»œåˆ†æå‡ºè¾“å‡ºå€¼</span></span><br><span class="line">        x = F.relu(self.hidden(x))      <span class="comment"># æ¿€åŠ±å‡½æ•°(éšè—å±‚çš„çº¿æ€§å€¼)</span></span><br><span class="line">        x = self.predict(x)             <span class="comment"># è¾“å‡ºå€¼</span></span><br><span class="line">        <span class="keyword">return</span> x</span><br></pre></td></tr></table></figure>
<p>åœ¨  $$init$$ï¼ˆï¼‰è¿›è¡Œå®šä¹‰æ‰€æœ‰å±‚çš„å±æ€§ï¼Œå†é€šè¿‡$$forward$$ ( )å‡½æ•°è¿›è¡Œè¿æ¥å±‚ä¸å±‚çš„å…³ç³» ï¼Œå»ºç«‹å…³ç³»çš„æ—¶å€™ï¼Œä¼šç”¨åˆ°æ¿€åŠ±å‡½æ•° $$F$$ï¼Œæ­¤æ—¶æ‰“å° $$Net$$ ç»“æ„</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Net(</span><br><span class="line">  (hidden): Linear(in_features=1, out_features=10, bias=True)</span><br><span class="line">  (predict): Linear(in_features=10, out_features=1, bias=True)</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
</li>
<li><p>è®­ç»ƒç½‘ç»œ</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># optimizer æ˜¯è®­ç»ƒçš„å·¥å…·</span></span><br><span class="line">optimizer = torch.optim.SGD(net.parameters(), lr=<span class="number">0.2</span>)  <span class="comment"># ä¼ å…¥netçš„æ‰€æœ‰å‚æ•°, å­¦ä¹ ç‡(&lt;1)</span></span><br><span class="line">loss_func = torch.nn.MSELoss()      <span class="comment"># é¢„æµ‹å€¼å’ŒçœŸå®å€¼çš„è¯¯å·®è®¡ç®—å…¬å¼ (å‡æ–¹å·®)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> t <span class="keyword">in</span> range(<span class="number">100</span>):</span><br><span class="line">    prediction = net(x)     <span class="comment"># å–‚ç»™ net è®­ç»ƒæ•°æ® x, è¾“å‡ºé¢„æµ‹å€¼</span></span><br><span class="line"></span><br><span class="line">    loss = loss_func(prediction, y)     <span class="comment"># è®¡ç®—ä¸¤è€…çš„è¯¯å·®</span></span><br><span class="line"></span><br><span class="line">    optimizer.zero_grad()   <span class="comment"># æ¸…ç©ºä¸Šä¸€æ­¥çš„æ®‹ä½™æ›´æ–°å‚æ•°å€¼</span></span><br><span class="line">    loss.backward()         <span class="comment"># è¯¯å·®åå‘ä¼ æ’­, è®¡ç®—å‚æ•°æ›´æ–°å€¼</span></span><br><span class="line">    optimizer.step()        <span class="comment"># å°†å‚æ•°æ›´æ–°å€¼æ–½åŠ åˆ° net çš„ parameters ä¸Š</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>æŸ¥çœ‹ loss</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;</span> tensor(0.0064, grad_fn=&lt;MseLossBackward&gt;)</span><br></pre></td></tr></table></figure>
</li>
</ul>

  </div>
</article>
      </main>
    </div>
  </body>
</html>